!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e||self).pegasysHelpers={})}(this,function(e){var n=/*#__PURE__*/function(){function e(){}return e.prototype.createQuestion=function(e,n){return{id:e,description:n}},e}();function t(e,n){try{var t=e()}catch(e){return n(e)}return t&&t.then?t.then(void 0,n):t}var r=/*#__PURE__*/function(){function e(){}var n=e.prototype;return n.performOperations=function(e,n,t,r,o,i,s,u,c,a){try{var f=this,h=null;return Promise.resolve(f.getOauthAccessToken(e,n,t,r)).then(function(e){if(!e)throw new Error("Failed to obtain access token");return Promise.resolve(f.getAuthorizationHeader(e)).then(function(e){return h=e,Promise.resolve(f.getDocumentsList(o,i,s,h)).then(function(e){return Promise.resolve(f.getDocumentDetails(o,e,h)).then(function(n){return Promise.resolve(f.generateAuditInfo(e,n)).then(function(e){return Promise.resolve(a(e)).then(function(n){var t=n.score;return e.assertionFails=n.assertion_fails,console.log("auditInfo assertion fails:\n"+JSON.stringify(e.assertionFails,null,2)),{validationId:u,maxScore:c,finalScore:t,auditInfo:e}})})})})})})}catch(e){return Promise.reject(e)}},n.getOauthAccessToken=function(e,n,r,o){try{var i=new Headers;i.append("Content-Type","application/x-www-form-urlencoded");var s=new URLSearchParams;s.append("grant_type","client_credentials"),s.append("client_id",e),s.append("client_secret",n),s.append("scope","document:documents:read document:documents:write document:environment-shares:read document:direct-shares:read "),s.append("resource",r);var u={method:"POST",headers:i,body:s,redirect:"follow"};return Promise.resolve(t(function(){return Promise.resolve(fetch(o,u)).then(function(e){return Promise.resolve(e.json()).then(function(e){return e.access_token})})},function(e){var n=function(){if(e.response)return Promise.resolve(e.response.text()).then(function(n){console.error("oAuth Access Token Error:",e.response.status,n)});console.error("oAuth Access Token Error:",e.message)}();return n&&n.then?n.then(function(){}):void 0}))}catch(e){return Promise.reject(e)}},n.getAuthorizationHeader=function(e){try{var n=new Headers;return n.append("Authorization","Bearer "+e),Promise.resolve(n)}catch(e){return Promise.reject(e)}},n.getEntities=function(e,n,r,o){try{var i=new Request(e+"/api/v2/entities?entitySelector=type("+n+"),entityName.contains("+r+")",{method:"GET",headers:o}),s=null,u=t(function(){return Promise.resolve(fetch(i)).then(function(e){var n=e.ok?Promise.resolve(e.json()).then(function(e){s=e}):Promise.resolve(e.text()).then(function(n){console.error("Entity ID Error:",e.status,n)});if(n&&n.then)return n.then(function(){})})},function(e){console.error(e)});return Promise.resolve(u&&u.then?u.then(function(){return s}):s)}catch(e){return Promise.reject(e)}},n.getEntitiesData=function(e,n,r){try{if(null===n)return Promise.resolve([]);var o=[],i=c(n.entities,function(n){var i=new Request(e+"/api/v2/entities/"+n.entityId,{method:"GET",headers:r}),s=t(function(){return Promise.resolve(fetch(i)).then(function(e){var n=e.ok?Promise.resolve(e.json()).then(function(e){o.push(e)}):Promise.resolve(e.text()).then(function(n){console.error("Entity Details Error:",e.status,n)});if(n&&n.then)return n.then(function(){})})},function(e){console.error(e)});if(s&&s.then)return s.then(function(){})});return Promise.resolve(i&&i.then?i.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},n.getDocumentsList=function(e,n,r,o){try{var i=new Request(e+"/platform/document/v1/documents?filter="+encodeURIComponent("name contains '"+r+"' and type == '"+n+"'"),{method:"GET",headers:o}),s=null,u=t(function(){return Promise.resolve(fetch(i)).then(function(e){var n=e.ok?Promise.resolve(e.json()).then(function(e){s=e}):Promise.resolve(e.text()).then(function(n){console.error("Document List Error:",e.status,n)});if(n&&n.then)return n.then(function(){})})},function(e){console.error(e)});return Promise.resolve(u&&u.then?u.then(function(){return s}):s)}catch(e){return Promise.reject(e)}},n.getDocumentDetails=function(e,n,r){try{if(null===n)return Promise.resolve([]);var o=[],i={method:"GET",headers:r},s=c(n.documents,function(n){var r=String(n.id),s=t(function(){return Promise.resolve(fetch(e+"/platform/document/v1/documents/"+r+"/content",i)).then(function(e){var n=e.ok?Promise.resolve(e.json()).then(function(e){o.push(e)}):Promise.resolve(e.text()).then(function(n){console.error("Document Details Error:",e.status,n)});if(n&&n.then)return n.then(function(){})})},function(e){console.error(e)});if(s&&s.then)return s.then(function(){})});return Promise.resolve(s&&s.then?s.then(function(){return o}):o)}catch(e){return Promise.reject(e)}},n.generateAuditInfo=function(e,n){try{var t={};return null!=e&&(t.documentList=e),null!=n&&(t.documentDetails=n),t.assertionFails=[],Promise.resolve(t)}catch(e){return Promise.reject(e)}},n.checkKeywordsExistence=function(e,n){return n.every(function(n){return e.toLowerCase().includes(n.toLowerCase())})},e}();const o="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function i(e,n,t){if(!e.s){if(t instanceof s){if(!t.s)return void(t.o=i.bind(null,e,n));1&n&&(n=t.s),t=t.v}if(t&&t.then)return void t.then(i.bind(null,e,n),i.bind(null,e,2));e.s=n,e.v=t;var r=e.o;r&&r(e)}}var s=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(n,t){var r=new e,o=this.s;if(o){var s=1&o?n:t;if(s){try{i(r,1,s(this.v))}catch(e){i(r,2,e)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?i(r,1,n?n(o):o):t?i(r,1,t(o)):i(r,2,o)}catch(e){i(r,2,e)}},r},e}();function u(e){return e instanceof s&&1&e.s}function c(e,n,t){if("function"==typeof e[o]){var r,c,a,f=function(e){try{for(;!((r=h.next()).done||t&&t());)if((e=n(r.value))&&e.then){if(!u(e))return void e.then(f,a||(a=i.bind(null,c=new s,2)));e=e.v}c?i(c,1,e):c=e}catch(e){i(c||(c=new s),2,e)}},h=e[o]();if(f(),h.return){var l=function(e){try{r.done||h.return()}catch(e){}return e};if(c&&c.then)return c.then(l,function(e){throw l(e)});l()}return c}if(!("length"in e))throw new TypeError("Object is not iterable");for(var d=[],v=0;v<e.length;v++)d.push(e[v]);return function(e,n,t){var r,o,c=-1;return function a(f){try{for(;++c<e.length&&(!t||!t());)if((f=n(c))&&f.then){if(!u(f))return void f.then(a,o||(o=i.bind(null,r=new s,2)));f=f.v}r?i(r,1,f):r=f}catch(e){i(r||(r=new s),2,e)}}(),r}(d,function(e){return n(d[e])},t)}e.DTFunctions=r,e.QuestionSDK=n});
//# sourceMappingURL=index.umd.js.map
