!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e||self).pegasysHelpers={})}(this,function(e){var n=/*#__PURE__*/function(){function e(){}return e.prototype.createQuestion=function(e,n){return{id:e,description:n}},e}();function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function r(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,n){try{var t=e()}catch(e){return n(e)}return t&&t.then?t.then(void 0,n):t}var i=/*#__PURE__*/function(){function e(){}var n=e.prototype;return n.performGradingPlatform=function(e,n,t,r,o,i,s,u,c,f){try{var a=this,l=null;return Promise.resolve(a.getOauthAccessToken(e,n,t,r)).then(function(e){if(!e)throw new Error("Failed to obtain access token");return Promise.resolve(a.getAuthorizationHeaderPlatform(e)).then(function(e){return l=e,Promise.resolve(a.getDocumentsList(o,i,s,l)).then(function(e){return Promise.resolve(a.getDocumentDetails(o,e,l)).then(function(n){return Promise.resolve(a.generateAuditInfo(e,n)).then(function(e){return Promise.resolve(f(e)).then(function(n){var t=n.score;return e.assertionFails=n.assertion_fails,{validationId:u,maxScore:c,finalScore:t,auditInfo:e}})})})})})})}catch(e){return Promise.reject(e)}},n.performGradingGen2=function(e,n,t,r,o,i,s,u,c,f){try{var a=this,l=null;return Promise.resolve(a.getOauthAccessToken(e,n,t,r)).then(function(e){if(!e)throw new Error("Failed to obtain access token");return Promise.resolve(a.getAuthorizationHeaderGen2(e)).then(function(e){return l=e,Promise.resolve(a.getDocumentsList(o,i,s,l)).then(function(e){return Promise.resolve(a.getDocumentDetails(o,e,l)).then(function(n){return Promise.resolve(a.generateAuditInfo(e,n)).then(function(e){return Promise.resolve(f(e)).then(function(n){var t=n.score;return e.assertionFails=n.assertion_fails,{validationId:u,maxScore:c,finalScore:t,auditInfo:e}})})})})})})}catch(e){return Promise.reject(e)}},n.getOauthAccessToken=function(e,n,t,r){try{var i=new Headers;i.append("Content-Type","application/x-www-form-urlencoded");var s=new URLSearchParams;s.append("grant_type","client_credentials"),s.append("client_id",e),s.append("client_secret",n),s.append("scope","document:documents:read document:documents:write document:environment-shares:read document:direct-shares:read "),s.append("resource",t);var u={method:"POST",headers:i,body:s,redirect:"follow"};return Promise.resolve(o(function(){return Promise.resolve(fetch(r,u)).then(function(e){return Promise.resolve(e.json()).then(function(e){return e.access_token})})},function(e){var n=function(){if(e.response)return Promise.resolve(e.response.text()).then(function(n){console.error("oAuth Access Token Error:",e.response.status,n)});console.error("oAuth Access Token Error:",e.message)}();return n&&n.then?n.then(function(){}):void 0}))}catch(e){return Promise.reject(e)}},n.getAuthorizationHeaderPlatform=function(e){try{var n=new Headers;return n.append("Authorization","Bearer "+e),Promise.resolve(n)}catch(e){return Promise.reject(e)}},n.getAuthorizationHeaderGen2=function(e){try{var n=new Headers;return n.append("Authorization","Api-Token "+e),Promise.resolve(n)}catch(e){return Promise.reject(e)}},n.getEntities=function(e,n,t,r){try{var i=new Request(e+"/api/v2/entities?entitySelector=type("+n+"),entityName.contains("+t+")",{method:"GET",headers:r}),s=null,u=o(function(){return Promise.resolve(fetch(i)).then(function(e){var n=e.ok?Promise.resolve(e.json()).then(function(e){s=e}):Promise.resolve(e.text()).then(function(n){console.error("Entity ID Error:",e.status,n)});if(n&&n.then)return n.then(function(){})})},function(e){console.error(e)});return Promise.resolve(u&&u.then?u.then(function(){return s}):s)}catch(e){return Promise.reject(e)}},n.getEntitiesData=function(e,n,t){try{if(null===n)return Promise.resolve([]);var r=[],i=l(n.entities,function(n){var i=new Request(e+"/api/v2/entities/"+n.entityId,{method:"GET",headers:t}),s=o(function(){return Promise.resolve(fetch(i)).then(function(e){var n=e.ok?Promise.resolve(e.json()).then(function(e){r.push(e)}):Promise.resolve(e.text()).then(function(n){console.error("Entity Details Error:",e.status,n)});if(n&&n.then)return n.then(function(){})})},function(e){console.error(e)});if(s&&s.then)return s.then(function(){})});return Promise.resolve(i&&i.then?i.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},n.getConfigsList=function(e,n,t,r,o,i){try{var s=this,u=[];if(""===n||!o)return Promise.resolve([]);var c="",f=function(){if(r.includes("/")){var f=l(o.entities,function(o){return c="/"+o.entityId+r,Promise.resolve(s.callConfigList(e,n,t,c,i)).then(function(e){u.push(e)})});if(f&&f.then)return f.then(function(){})}else{var a=r.includes("?")?(c=r,Promise.resolve(s.callConfigList(e,n,t,c,i)).then(function(e){u.push(e)})):Promise.resolve(s.callConfigList(e,n,t,c,i)).then(function(e){u.push(e)});if(a&&a.then)return a.then(function(){})}}();return Promise.resolve(f&&f.then?f.then(function(){return u}):u)}catch(e){return Promise.reject(e)}},n.callConfigList=function(e,n,t,r,i){try{var s=new Request(e+n+r,{method:"GET",headers:i}),u=[],c=o(function(){return Promise.resolve(fetch(s)).then(function(e){var n=e.ok?Promise.resolve(e.json()).then(function(e){u=e}):Promise.resolve(e.text()).then(function(n){console.error("ConfigList Error:",e.status,n)});if(n&&n.then)return n.then(function(){})})},function(e){console.error(e)});return Promise.resolve(c&&c.then?c.then(function(){return u}):u)}catch(e){return Promise.reject(e)}},n.getConfigsData=function(e,n,t,r){try{if(null===t)return Promise.resolve([]);var i=[],s=l(t,function(t){return function(s){var u=[];for(var c in s)u.push(c);return a(u,function(s){return function(s){return function(){if(s&&null!=s&&Array.isArray(t[s]))return l(t[s],function(t){var s=t?t.entityId||t.id:null,u=function(){if(s){var t=new Request(e+n+"/"+s,{method:"GET",headers:r}),u=o(function(){return Promise.resolve(fetch(t)).then(function(e){var n=e.ok?Promise.resolve(e.json()).then(function(e){i.push(e)}):Promise.resolve(e.text()).then(function(n){console.error("Config Data Error:",e.status,n)});if(n&&n.then)return n.then(function(){})})},function(e){console.error(e)});if(u&&u.then)return u.then(function(){})}}();if(u&&u.then)return u.then(function(){})})}()}(u[s])},void 0)}(t)});return Promise.resolve(s&&s.then?s.then(function(){return i}):i)}catch(e){return Promise.reject(e)}},n.getSettingsData=function(e,n,t,i,s){try{var u=[];if(""===i)return Promise.resolve([]);var c="";if("entity"===s)for(var f,a=r(n.entities);!(f=a()).done;)c=c+f.value.entityId+",";else c=s;if(""==c)return Promise.resolve([]);var l=new Request(e+"/api/v2/settings/objects?schemaIds="+i+"&scopes="+c,{method:"GET",headers:t}),h=o(function(){return Promise.resolve(fetch(l)).then(function(e){var n=e.ok?Promise.resolve(e.json()).then(function(e){u.push(e)}):Promise.resolve(e.text()).then(function(n){console.error("Settings Data Error:",e.status,n)});if(n&&n.then)return n.then(function(){})})},function(e){console.error(e)});return Promise.resolve(h&&h.then?h.then(function(){return u}):u)}catch(e){return Promise.reject(e)}},n.getProblemsData=function(e,n,t){try{if(!n||!n.entities||n.entities.length<=0)return Promise.resolve(null);for(var i,s="",u=r(n.entities);!(i=u()).done;)s+=","+i.value.entityId;s=s.substring(1);var c=new Request(e+"/api/v2/problems?from=now-6h&problemSelector=rootCauseEntity("+s+")",{method:"GET",headers:t}),f=null,a=o(function(){return Promise.resolve(fetch(c)).then(function(e){var n=e.ok?Promise.resolve(e.json()).then(function(e){f=e}):Promise.resolve(e.text()).then(function(n){console.error("Problems Data Error:",e.status,n)});if(n&&n.then)return n.then(function(){})})},function(e){console.error(e)});return Promise.resolve(a&&a.then?a.then(function(){return f}):f)}catch(e){return Promise.reject(e)}},n.getDocumentsList=function(e,n,t,r){try{var i=new Request(e+"/platform/document/v1/documents?filter="+encodeURIComponent("name contains '"+t+"' and type == '"+n+"'"),{method:"GET",headers:r}),s=null,u=o(function(){return Promise.resolve(fetch(i)).then(function(e){var n=e.ok?Promise.resolve(e.json()).then(function(e){s=e}):Promise.resolve(e.text()).then(function(n){console.error("Document List Error:",e.status,n)});if(n&&n.then)return n.then(function(){})})},function(e){console.error(e)});return Promise.resolve(u&&u.then?u.then(function(){return s}):s)}catch(e){return Promise.reject(e)}},n.getDocumentDetails=function(e,n,t){try{if(null===n)return Promise.resolve([]);var r=[],i={method:"GET",headers:t},s=l(n.documents,function(n){var t=String(n.id),s=o(function(){return Promise.resolve(fetch(e+"/platform/document/v1/documents/"+t+"/content",i)).then(function(e){var n=e.ok?Promise.resolve(e.json()).then(function(e){r.push(e)}):Promise.resolve(e.text()).then(function(n){console.error("Document Details Error:",e.status,n)});if(n&&n.then)return n.then(function(){})})},function(e){console.error(e)});if(s&&s.then)return s.then(function(){})});return Promise.resolve(s&&s.then?s.then(function(){return r}):r)}catch(e){return Promise.reject(e)}},n.generateAuditInfo=function(e,n){try{var t={};return null!=e&&(t.documentList=e),null!=n&&(t.documentDetails=n),t.assertionFails=[],Promise.resolve(t)}catch(e){return Promise.reject(e)}},n.checkKeywordsExistence=function(e,n){return n.every(function(n){return e.toLowerCase().includes(n.toLowerCase())})},n.findIdInObject=function(e){for(var n in e)if(e.hasOwnProperty(n))if("object"==typeof e[n]){var t=this.findIdInObject(e[n]);if(t)return t}else if("id"===n||"entityId"===n)return e[n];return null},e}();const s="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function u(e,n,t){if(!e.s){if(t instanceof c){if(!t.s)return void(t.o=u.bind(null,e,n));1&n&&(n=t.s),t=t.v}if(t&&t.then)return void t.then(u.bind(null,e,n),u.bind(null,e,2));e.s=n,e.v=t;var r=e.o;r&&r(e)}}var c=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(n,t){var r=new e,o=this.s;if(o){var i=1&o?n:t;if(i){try{u(r,1,i(this.v))}catch(e){u(r,2,e)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?u(r,1,n?n(o):o):t?u(r,1,t(o)):u(r,2,o)}catch(e){u(r,2,e)}},r},e}();function f(e){return e instanceof c&&1&e.s}function a(e,n,t){var r,o,i=-1;return function s(a){try{for(;++i<e.length&&(!t||!t());)if((a=n(i))&&a.then){if(!f(a))return void a.then(s,o||(o=u.bind(null,r=new c,2)));a=a.v}r?u(r,1,a):r=a}catch(e){u(r||(r=new c),2,e)}}(),r}function l(e,n,t){if("function"==typeof e[s]){var r,o,i,l=function(e){try{for(;!((r=h.next()).done||t&&t());)if((e=n(r.value))&&e.then){if(!f(e))return void e.then(l,i||(i=u.bind(null,o=new c,2)));e=e.v}o?u(o,1,e):o=e}catch(e){u(o||(o=new c),2,e)}},h=e[s]();if(l(),h.return){var v=function(e){try{r.done||h.return()}catch(e){}return e};if(o&&o.then)return o.then(v,function(e){throw v(e)});v()}return o}if(!("length"in e))throw new TypeError("Object is not iterable");for(var m=[],d=0;d<e.length;d++)m.push(e[d]);return a(m,function(e){return n(m[e])},t)}e.DTFunctions=i,e.QuestionSDK=n});
//# sourceMappingURL=index.umd.js.map
